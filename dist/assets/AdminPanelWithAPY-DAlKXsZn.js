import{u as s,j as e}from"./index-BkZZq67j.js";import{r as a,C as t,R as n,T as i,d as r,D as l,e as d,P as c,f as o}from"./ui-CjFzYUMr.js";import{u,a as m}from"./useMutation-BChOhwjn.js";import{a as p,p as h}from"./ethers-BDgFcnCu.js";import"./vendor-CtPCxZU4.js";const x=({account:x,provider:j,signer:w,contractAddresses:g,treasuryContract:v})=>{const[y,N]=a.useState(""),[P,b]=a.useState(""),[S,f]=a.useState(""),[z,C]=a.useState(""),[A,Y]=a.useState("");if(!(x&&g.owner&&x.toLowerCase()===g.owner.toLowerCase()))return null;const E=(s,e="success")=>{Y({text:s,type:e}),setTimeout(()=>Y(""),3e3)},F=s(),{data:H,refetch:T}=u({queryKey:["treasuryStatus",g.treasury],queryFn:async()=>{if(!v)return null;const[s,e,a,t,n,i]=await Promise.all([v.getTreasuryBalance(),v.paused(),v.owner(),v.getAPYPercentage(),v.getTotalDeposits(),v.getTotalRewardsDistributed()]);return{balance:s.toString(),paused:e,owner:a,apy:t.toString(),totalDeposits:n.toString(),totalRewards:i.toString()}},enabled:!!v,refetchInterval:5e3}),$=m({mutationFn:async s=>{const e=h(s),a=await v.adminWithdraw(e,{gasLimit:2e5});await a.wait()},onSuccess:()=>{E("HYPE withdrawn successfully!"),N(""),F.invalidateQueries(["treasuryStatus"]),F.invalidateQueries(["userBalances"])},onError:s=>{E(`Withdraw failed: ${s.reason||s.message}`,"error")}}),Q=m({mutationFn:async()=>{const s=await v.adminWithdrawAll({gasLimit:2e5});await s.wait()},onSuccess:()=>{E("All HYPE withdrawn successfully!"),F.invalidateQueries(["treasuryStatus"]),F.invalidateQueries(["userBalances"])},onError:s=>{E(`Withdraw all failed: ${s.reason||s.message}`,"error")}}),k=m({mutationFn:async({to:s,amount:e})=>{const a=h(e),t=await v.adminMint(s,a,{gasLimit:2e5});await t.wait()},onSuccess:()=>{E("zHYPE minted successfully!"),b(""),f(""),F.invalidateQueries(["zHypeTokenBalance"])},onError:s=>{E(`Mint failed: ${s.reason||s.message}`,"error")}}),L=m({mutationFn:async s=>{const e=100*s,a=await v.setAPY(e,{gasLimit:15e4});await a.wait()},onSuccess:()=>{E(`APY updated to ${z}%!`),C(""),F.invalidateQueries(["treasuryStatus"]),F.invalidateQueries(["apyInfo"])},onError:s=>{E(`APY update failed: ${s.reason||s.message}`,"error")}}),R=m({mutationFn:async()=>{const s=await v.pause({gasLimit:1e5});await s.wait()},onSuccess:()=>{E("Treasury paused!"),F.invalidateQueries(["treasuryStatus"])},onError:s=>{E(`Pause failed: ${s.reason||s.message}`,"error")}}),W=m({mutationFn:async()=>{const s=await v.unpause({gasLimit:1e5});await s.wait()},onSuccess:()=>{E("Treasury unpaused!"),F.invalidateQueries(["treasuryStatus"])},onError:s=>{E(`Unpause failed: ${s.reason||s.message}`,"error")}}),D=s=>s?p(s,18):"0",B=s=>s?parseFloat(s).toFixed(2):"0.00";return e.jsxs("div",{className:"admin-panel",children:[e.jsxs("div",{className:"admin-panel-header",children:[e.jsx("h2",{children:"Treasury Admin Panel v0.3"}),e.jsxs("span",{className:"owner-badge",children:[e.jsx(t,{size:16})," OWNER"]}),e.jsx("button",{className:"refresh-btn",onClick:()=>T(),title:"Refresh Status",children:e.jsx(n,{size:20})})]}),A&&e.jsx("div",{className:`admin-message ${A.type}`,children:A.text}),e.jsxs("div",{className:"admin-status",children:[e.jsxs("div",{className:"status-item",children:[e.jsx("span",{children:"Treasury Balance:"}),e.jsxs("span",{children:[H?D(H.balance):"0"," HYPE"]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{children:"Status:"}),e.jsx("span",{className:H?.paused?"status-paused":"status-active",children:H?.paused?"Paused":"Active"})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{children:"Current APY:"}),e.jsxs("span",{className:"apy-value",children:[e.jsx(i,{size:14}),H?B(H.apy):"0.00","%"]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{children:"Total Deposits:"}),e.jsxs("span",{children:[H?D(H.totalDeposits):"0"," HYPE"]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{children:"Rewards Distributed:"}),e.jsxs("span",{children:[H?D(H.totalRewards):"0"," HYPE"]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{children:"Owner:"}),e.jsx("span",{children:H?.owner?`${H.owner.slice(0,6)}...${H.owner.slice(-4)}`:"N/A"})]})]}),e.jsxs("div",{className:"admin-actions-grid",children:[e.jsxs("div",{className:"admin-action-card apy-card",children:[e.jsx("h3",{children:"ðŸŽ¯ APY Control"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"number",placeholder:"New APY (%)",value:z,onChange:s=>C(s.target.value),min:"0",max:"500",step:"0.1"}),e.jsxs("button",{className:"action-btn apy-btn",onClick:()=>L.mutate(parseFloat(z)),disabled:L.isPending||!z||parseFloat(z)<0||parseFloat(z)>500,children:[L.isPending?e.jsx(n,{size:16,className:"spinner"}):e.jsx(r,{size:16}),"Set APY"]})]}),e.jsxs("div",{className:"current-apy",children:["Current: ",H?B(H.apy):"0.00","%"]})]}),e.jsxs("div",{className:"admin-action-card",children:[e.jsx("h3",{children:"Withdraw HYPE"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"number",placeholder:"Amount (HYPE)",value:y,onChange:s=>N(s.target.value),min:"0",step:"0.001"}),e.jsxs("button",{className:"action-btn withdraw-btn",onClick:()=>$.mutate(y),disabled:$.isPending||!y||parseFloat(y)<=0,children:[$.isPending?e.jsx(n,{size:16,className:"spinner"}):e.jsx(l,{size:16}),"Withdraw"]})]}),e.jsxs("button",{className:"action-btn withdraw-all-btn",onClick:()=>Q.mutate(),disabled:Q.isPending,children:[Q.isPending?e.jsx(n,{size:16,className:"spinner"}):e.jsx(l,{size:16}),"Withdraw All"]})]}),e.jsxs("div",{className:"admin-action-card",children:[e.jsx("h3",{children:"Mint zHYPE"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",placeholder:"Recipient Address",value:S,onChange:s=>f(s.target.value)}),e.jsx("input",{type:"number",placeholder:"Amount (zHYPE)",value:P,onChange:s=>b(s.target.value),min:"0",step:"0.001"}),e.jsxs("button",{className:"action-btn mint-btn",onClick:()=>k.mutate({to:S,amount:P}),disabled:k.isPending||!S||!P||parseFloat(P)<=0,children:[k.isPending?e.jsx(n,{size:16,className:"spinner"}):e.jsx(d,{size:16}),"Mint"]})]})]}),e.jsxs("div",{className:"admin-action-card",children:[e.jsx("h3",{children:"Control Operations"}),e.jsxs("div",{className:"button-group",children:[e.jsxs("button",{className:"action-btn pause-btn",onClick:()=>R.mutate(),disabled:R.isPending||H?.paused,children:[R.isPending?e.jsx(n,{size:16,className:"spinner"}):e.jsx(c,{size:16}),"Pause"]}),e.jsxs("button",{className:"action-btn unpause-btn",onClick:()=>W.mutate(),disabled:W.isPending||!H?.paused,children:[W.isPending?e.jsx(n,{size:16,className:"spinner"}):e.jsx(o,{size:16}),"Unpause"]})]})]})]})]})};export{x as default};
